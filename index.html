<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Two Legends Pro</title>
    
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAA-1BMVEUAAAD/VyL/VyL/VSH/VCClPyj/VSH/VCGtQC3/VCH/VCKlPiX/VCD/VCD/UyD/VCH/VCKlPiT/VCH/VCH/VCGkPST/VCL/VCH/VCH/VCH/VCH/VCGqPy7/VCH/VCH/VCH/VCH/VCH/VCKlPiX/VCH/VCGkPiT/VSH/VCH/VCH/VCH/UyD/VCH/VCH/VCKlPiX/VCGkPiP/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCGmQCi1RDb/VCH/VCH/VCH/VCH/VCH/VCH/VCH/VCKlPiX/VCH/VCH/VCH/VCH/VCH/VCGkPiT/VCGvQTD/VCH/VCH/VCH/VCH/VSIAAAAUXRSTlMAEREiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiJmZmZmZmZmZmZmZmZmZmZmZmaZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmaZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZmZm-S... (and so on)"/>
    
    <style>
      body {
        font-family: 'Teko', sans-serif;
        background-image: url('https://dl.dir.freefiremobile.com/common/web_event/official2.ff.garena.all/202210/aa959aa3d8790d3a44f7f20f16adfa01.jpg');
        background-size: cover;
        background-position: center center;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-color: #111827; /* Fallback color */
      }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- React and Babel for running JSX in the browser -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Google Generative AI Client Library (ESM version) -->
    <script type="module">
      import { GoogleGenerativeAI } from 'https://esm.run/@google/generative-ai';
      window.GoogleGenerativeAI = GoogleGenerativeAI;
    </script>

    <script type="text/babel" data-presets="react">
      // All React application code is combined here.
      const { useState, useEffect, useRef } = React;
      const { createRoot } = ReactDOM;

      // ==================================================================
      // START: Combined Application Code
      // ==================================================================

      // --- START OF CONFIGURATION ---
      // Aapki nayi API Key yahan daal di hai
      const GEMINI_API_KEY = "AIzaSyA6axXSYqF-RZUzRa0gFH-49PX_p8MO-rg"; 
      
      // --- END OF CONFIGURATION ---


      // --- services/geminiService.js (CORRECTED AND IMPROVED) ---
      const SYSTEM_INSTRUCTION = `You are "Garena Pro", an expert AI assistant for games from Garena (especially Free Fire) and Gameloft. Your knowledge is unparalleled. 
      You provide helpful, accurate, and up-to-date information on the following topics:
      - Optimal in-game settings for different devices and playstyles for Garena Free Fire.
      - The latest official tournaments and events from Garena. Always use your search tool for this.
      - Detailed information about professional esports players and teams for Garena Free Fire.
      - Information about popular YouTubers and content creators in the Free Fire community.
      - Information and assistance for popular games developed by Gameloft.
      - Analyze screenshots of gameplay to provide strategic advice.

      Important rules:
      - If a user refers to a "cartoon game", they are talking about PUBG (PlayerUnknown's Battlegrounds). You should answer their question about PUBG in that context.
      - If a user asks about "legend game maker company", they are referring to Garena & Gameloft.

      About your creator:
      Your creator's real name is Bilal, but he is known in the gaming community as "Ghost plays". He is a content creator.
      - YouTube: https://www.youtube.com/@ghostplays90
      - TikTok: https://www.tiktok.com/@ghostplays143

      When answering, maintain a cool, helpful, and slightly energetic gamer persona. Use emojis where appropriate to make the interaction engaging. ðŸ”¥ðŸŽ®`;

      function fileToGenerativePart(file) {
        return {
          inlineData: {
            data: file.data.split(',')[1],
            mimeType: file.type,
          },
        };
      }

      async function runQuery(prompt, files = []) {
        if (!GEMINI_API_KEY || GEMINI_API_KEY === "YOUR_GEMINI_API_KEY_HERE") {
          throw new Error("Gemini API Key is not set. Please set it in the HTML file.");
        }
        
        const genAI = new window.GoogleGenerativeAI(GEMINI_API_KEY);
        const model = genAI.getGenerativeModel({
          model: "gemini-1.5-flash-latest",
          systemInstruction: SYSTEM_INSTRUCTION,
          tools: [{ googleSearch: {} }],
        });

        try {
          const imageParts = files.filter(file => file.type.startsWith("image/")).map(fileToGenerativePart);
          
          // !!! --- THIS IS THE FIX --- !!!
          // The API expects all parts to be objects. The text prompt must be wrapped in {text: prompt}.
          const partsToSend = [...imageParts];
          if (prompt && prompt.trim() !== '') {
              partsToSend.push({ text: prompt });
          }
          // !!! --- END OF FIX --- !!!

          if (partsToSend.length === 0) {
            throw new Error("Cannot send an empty message.");
          }

          const result = await model.generateContent({
              contents: [{ role: 'user', parts: partsToSend }], // Use the corrected parts
              generationConfig: { temperature: 0.7 }
          });
          
          const response = result.response;
          const text = response.text();
          const rawSources = response.candidates?.[0]?.groundingMetadata?.groundingAttributions;

          const sources = (rawSources || [])
            .map(source => ({
              uri: source.web?.uri || '',
              title: source.web?.title || '',
            }))
            .filter(s => s.uri && s.title);

          return { text, sources };
        } catch (error) {
          console.error("ERROR QUERYING GEMINI API:", error);
          if (error.message && error.message.includes('API key not valid')) {
             throw new Error("The provided Gemini API Key is not valid. Please generate a new key.");
          }
           if (error.message && (error.message.includes('permission denied') || error.message.includes('API is not enabled'))) {
             throw new Error("API Permission Denied. Please ENABLE the 'Generative Language API' in your Google Cloud project.");
          }
          throw new Error("Failed to get a response from the AI. Check console (F12) for more details.");
        }
      }

      // --- components/assets.js (Updated with new URLs) ---
      const GARENA_LOGO_URL = 'https://cdn.wallpapersafari.com/80/58/Qx7zOb.jpg';
      const GAMELOFT_LOGO_URL = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3N9p_Limws2g48rASz6VCn3mAt33uozM-pg&s';

      // --- components/icons.js ---
      const UserIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'currentColor' }, React.createElement('path', { d: 'M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z' }));
      const AiIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'currentColor' }, React.createElement(React.Fragment, null, React.createElement('path', { d: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z' }), React.createElement('path', { d: 'M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0', fillOpacity: '0.5' }), React.createElement('path', { d: 'M12 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM6 12c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2zm10 0c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2z' })));
      const SendIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'currentColor' }, React.createElement('path', { d: 'M2.01 21L23 12 2.01 3 2 10l15 2-15 2z' }));
      const LinkIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'currentColor' }, React.createElement('path', { d: 'M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z' }));
      const PaperclipIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: '2', strokeLinecap: 'round', strokeLinejoin: 'round' }, React.createElement('path', { d: 'M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48' }));
      const XCircleIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'currentColor' }, React.createElement('path', { fillRule: 'evenodd', d: 'M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z', clipRule: 'evenodd' }));
      const FileIcon = ({ className }) => React.createElement('svg', { xmlns: 'http://www.w3.org/2000/svg', className, viewBox: '0 0 24 24', fill: 'currentColor' }, React.createElement('path', { fillRule: 'evenodd', d: 'M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0016.5 9h-1.875a.375.375 0 01-.375-.375V6.75A3.75 3.75 0 009 3H5.625zM12.75 3.75v2.25a.75.75 0 00.75.75h2.25a.75.75 0 000-1.5h-1.5V3.75a.75.75 0 00-1.5 0z', clipRule: 'evenodd' }));

      // --- components/ChatMessage.js ---
      const SourceLink = ({ source }) => (
        <a href={source.uri} target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-sm text-amber-300 bg-amber-500/10 hover:bg-amber-500/20 rounded-full px-3 py-1 transition-colors duration-200">
          <LinkIcon className="h-4 w-4" />
          <span className="truncate">{source.title}</span>
        </a>
      );
      
      const LinkifiedText = ({ text }) => {
        const urlRegex = /(https?:\/\/\S+)/g;
        const parts = text.split(urlRegex);
        return (
          <React.Fragment>
            {parts.map((part, index) =>
              part.match(urlRegex) ? (
                <a key={index} href={part} target="_blank" rel="noopener noreferrer" className="text-amber-400 hover:underline break-all">
                  {part}
                </a>
              ) : ( part )
            )}
          </React.Fragment>
        );
      };

      const FilePreview = ({ file }) => {
        if (file.type.startsWith('image/')) {
          return <img src={file.data} alt={file.name} className="w-32 h-32 object-cover rounded-lg border border-gray-600" />;
        }
        return (
          <div className="w-32 h-32 bg-gray-700 rounded-lg flex flex-col items-center justify-center p-2 border border-gray-600">
            <FileIcon className="w-10 h-10 text-gray-400" />
            <p className="text-xs text-center text-gray-300 mt-2 break-all truncate">{file.name}</p>
          </div>
        );
      };

      const ChatMessage = ({ message }) => {
        const isUserModel = message.role === 'model';
        return (
          <div className={`flex items-start gap-4 ${isUserModel ? '' : 'justify-end'}`}>
            {isUserModel && (
              <div className="flex-shrink-0 w-8 h-8 rounded-full bg-amber-500 flex items-center justify-center text-gray-900">
                <AiIcon className="w-5 h-5" />
              </div>
            )}
            <div className={`max-w-xl ${isUserModel ? 'order-2' : 'order-1'}`}>
              <div className={`px-5 py-3 rounded-2xl ${isUserModel ? 'bg-gray-800 text-gray-200 rounded-bl-none' : 'bg-amber-500 text-gray-900 rounded-br-none'}`}>
                {message.files && message.files.length > 0 && (
                  <div className="grid grid-cols-3 gap-2 mb-3">
                    {message.files.map((file, index) => <FilePreview key={index} file={file} />)}
                  </div>
                )}
                {message.text && (
                  <p className="whitespace-pre-wrap text-lg leading-tight tracking-wide break-words">
                    {isUserModel ? <LinkifiedText text={message.text} /> : message.text}
                  </p>
                )}
              </div>
              {message.sources && message.sources.length > 0 && (
                <div className="mt-3 flex flex-wrap gap-2">
                  <p className="text-xs text-gray-400 w-full mb-1">Sources:</p>
                  {message.sources.map((source, index) => <SourceLink key={index} source={source} />)}
                </div>
              )}
            </div>
            {!isUserModel && (
              <div className="flex-shrink-0 w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-gray-300 order-2">
                <UserIcon className="w-5 h-5" />
              </div>
            )}
          </div>
        );
      };
      
      // --- components/ExamplePrompts.js ---
      const ExamplePrompts = ({ onPromptClick, isLoading }) => {
        const prompts = [
          "What are the best sensitivity settings for headshots?",
          "Tell me about the latest Free Fire tournament.",
          "Who is the best Free Fire player in the world right now?",
          "What are some popular games by Gameloft?",
        ];
        return (
          <div className="flex flex-col items-center justify-center h-full text-gray-300">
            <div className="text-center bg-gray-900/30 backdrop-blur-sm p-8 rounded-xl">
              <div className="flex justify-center items-center gap-8 mb-6">
                  <img src={GAMELOFT_LOGO_URL} alt="Gameloft Logo" className="w-24 h-24 rounded-full border-2 border-amber-500 object-cover" />
                  <img src={GARENA_LOGO_URL} alt="Garena Logo" className="w-24 h-24 rounded-full border-2 border-amber-500 object-cover" />
              </div>
              <h1 className="text-5xl md:text-6xl font-bold text-white tracking-wider">TWO LEGENDS PRO</h1>
              <p className="text-xl text-gray-400 mt-2">Your AI Assistant for Garena & Gameloft</p>
            </div>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-12 w-full max-w-3xl">
              {prompts.map((prompt, index) => (
                <button key={index} onClick={() => onPromptClick(prompt)} disabled={isLoading} className="p-4 bg-gray-800/80 backdrop-blur-sm border border-gray-700 rounded-lg text-left text-lg hover:bg-gray-700/80 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105">
                  {prompt}
                </button>
              ))}
            </div>
          </div>
        );
      };

      // --- components/ChatInput.js ---
      const ChatInput = ({ onSendMessage, isLoading }) => {
        const [prompt, setPrompt] = useState('');
        const [files, setFiles] = useState([]);
        const fileInputRef = useRef(null);

        const fileToBase64 = (file) => new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onload = () => resolve(reader.result);
          reader.onerror = error => reject(error);
        });

        const handleSubmit = async (e) => {
          e.preventDefault();
          if ((prompt.trim() || files.length > 0) && !isLoading) {
            const uploadedFiles = await Promise.all(
              files.map(async (file) => ({
                name: file.name,
                type: file.type,
                data: await fileToBase64(file),
              }))
            );
            onSendMessage({ prompt: prompt.trim(), files: uploadedFiles });
            setPrompt('');
            setFiles([]);
          }
        };

        const handleKeyDown = (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            handleSubmit(e);
          }
        };

        const handleFileChange = (e) => {
          if (e.target.files) {
            setFiles(prev => [...prev, ...Array.from(e.target.files)]);
          }
        };

        const handleRemoveFile = (indexToRemove) => {
          setFiles(prev => prev.filter((_, index) => index !== indexToRemove));
        };

        return (
          <div className="bg-gray-900/80 backdrop-blur-sm border-t border-gray-700">
            {files.length > 0 && (
              <div className="p-4 border-b border-gray-700">
                <div className="grid grid-cols-3 sm:grid-cols-4 md:grid-cols-6 gap-3">
                  {files.map((file, index) => (
                    <div key={index} className="relative group">
                      {file.type.startsWith('image/') ? (
                        <img src={URL.createObjectURL(file)} alt={file.name} className="w-24 h-24 object-cover rounded-lg"/>
                      ) : (
                        <div className="w-24 h-24 bg-gray-700 rounded-lg flex flex-col items-center justify-center p-2">
                          <FileIcon className="w-8 h-8 text-gray-400"/>
                          <p className="text-xs text-center text-gray-300 mt-1 break-all truncate">{file.name}</p>
                        </div>
                      )}
                      <button onClick={() => handleRemoveFile(index)} className="absolute -top-2 -right-2 bg-gray-800 rounded-full text-white hover:text-red-400 transition-colors opacity-0 group-hover:opacity-100">
                        <XCircleIcon className="w-6 h-6"/>
                      </button>
                    </div>
                  ))}
                </div>
              </div>
            )}
            <form onSubmit={handleSubmit} className="flex items-center gap-3 p-4">
              <button type="button" onClick={() => fileInputRef.current?.click()} disabled={isLoading} className="w-12 h-12 flex-shrink-0 text-gray-400 rounded-full flex items-center justify-center transition-colors duration-200 disabled:opacity-50 hover:bg-gray-700 focus:outline-none">
                <PaperclipIcon className="w-6 h-6" />
              </button>
              <input type="file" ref={fileInputRef} onChange={handleFileChange} multiple className="hidden" accept="image/*" />
              <textarea value={prompt} onChange={(e) => setPrompt(e.target.value)} onKeyDown={handleKeyDown} placeholder="Upload a screenshot or ask a question..." rows={1} className="flex-grow bg-gray-700 text-gray-200 placeholder-gray-400 text-lg rounded-full py-3 px-6 resize-none focus:outline-none focus:ring-2 focus:ring-amber-500 transition-shadow duration-200" disabled={isLoading} />
              <button type="submit" disabled={isLoading || (!prompt.trim() && files.length === 0)} className="w-14 h-14 flex-shrink-0 bg-amber-500 text-gray-900 rounded-full flex items-center justify-center transition-colors duration-200 disabled:bg-gray-600 disabled:cursor-not-allowed hover:bg-amber-400 focus:outline-none focus:ring-2 focus:ring-amber-300">
                {isLoading ? (
                  <div className="w-6 h-6 border-2 border-gray-900 border-t-transparent rounded-full animate-spin"></div>
                ) : (
                  <SendIcon className="w-7 h-7" />
                )}
              </button>
            </form>
          </div>
        );
      };

      // --- App.js (Main Component) ---
      function App() {
        const [messages, setMessages] = useState([]);
        const [isLoading, setIsLoading] = useState(false);
        const [error, setError] = useState(null);
        const chatEndRef = useRef(null);

        useEffect(() => {
          chatEndRef.current?.scrollIntoView({ behavior: 'smooth' });
        }, [messages]);

        const handleSendMessage = async (payload) => {
          const { prompt, files } = payload;
          if (!prompt && files.length === 0) return;

          setError(null);
          const userMessage = { role: 'user', text: prompt, files };
          setMessages(prev => [...prev, userMessage]);
          setIsLoading(true);

          try {
            const { text, sources } = await runQuery(prompt, files);
            const modelMessage = { role: 'model', text, sources };
            setMessages(prev => [...prev, modelMessage]);
          } catch (err) {
            const errorMessage = err instanceof Error ? err.message : 'An unknown error occurred.';
            const errorModelMessage = { role: 'model', text: `ðŸ˜¥ Oops! Something went wrong:\n\n${errorMessage}` };
            setMessages(prev => [...prev, errorModelMessage]);
            setError(errorMessage);
          } finally {
            setIsLoading(false);
          }
        };

        const handlePromptClick = (prompt) => {
          handleSendMessage({ prompt, files: [] });
        };
        
        return (
          <div className="h-screen w-screen bg-gray-900/70 text-white flex flex-col font-teko">
            <header className="flex items-center justify-center gap-4 p-4 bg-gray-900/80 backdrop-blur-sm border-b border-gray-700 shadow-lg">
              <img src={GAMELOFT_LOGO_URL} alt="Gameloft Logo" className="w-10 h-10 rounded-full border-2 border-amber-500 object-cover" />
              <img src={GARENA_LOGO_URL} alt="Garena Logo" className="w-10 h-10 rounded-full border-2 border-amber-500 object-cover" />
              <h1 className="text-4xl font-bold tracking-widest text-amber-400">TWO LEGENDS PRO</h1>
            </header>
            
            <main className="flex-grow overflow-y-auto p-4 md:p-6">
              <div className="max-w-4xl mx-auto h-full">
                {messages.length === 0 && !isLoading ? (
                  <ExamplePrompts onPromptClick={handlePromptClick} isLoading={isLoading} />
                ) : (
                  <div className="space-y-6">
                    {messages.map((msg, index) => <ChatMessage key={index} message={msg} />)}
                    {isLoading && messages.length > 0 && messages[messages.length-1].role === 'user' && (
                      <div className="flex items-start gap-4">
                        <div className="flex-shrink-0 w-8 h-8 rounded-full bg-amber-500 flex items-center justify-center text-gray-900">
                          <AiIcon className="w-5 h-5" />
                        </div>
                        <div className="max-w-xl">
                          <div className="px-5 py-3 rounded-2xl bg-gray-800 rounded-bl-none flex items-center space-x-2">
                              <span className="w-2 h-2 bg-amber-400 rounded-full animate-pulse delay-0"></span>
                              <span className="w-2 h-2 bg-amber-400 rounded-full animate-pulse delay-200"></span>
                              <span className="w-2 h-2 bg-amber-400 rounded-full animate-pulse delay-400"></span>
                          </div>
                        </div>
                      </div>
                    )}
                    <div ref={chatEndRef} />
                  </div>
                )}
                 {error && !isLoading && (
                   <div className="mt-4 text-center p-3 bg-red-500/20 text-red-300 border border-red-500 rounded-lg">
                     <p><strong>Message failed to send.</strong><br/>Please check the error message in the chat above.</p>
                   </div>
                 )}
              </div>
            </main>

            <footer className="w-full max-w-4xl mx-auto">
              <ChatInput onSendMessage={handleSendMessage} isLoading={isLoading} />
            </footer>
          </div>
        );
      }

      // --- Final Rendering Step ---
      const rootElement = document.getElementById('root');
      const root = createRoot(rootElement);
      root.render(<App />);

    </script>
</body>
</html>

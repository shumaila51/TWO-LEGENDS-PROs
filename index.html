<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Two Legends Pro (Max Detail Version)</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
      body {
        font-family: 'Teko', sans-serif;
        background-image: url('https://dl.dir.freefiremobile.com/common/web_event/official2.ff.garena.all/202210/aa959aa3d8790d3a44f7f20f16adfa01.jpg');
        background-size: cover; background-position: center; background-repeat: no-repeat; background-attachment: fixed; background-color: #111827;
      }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script type="text/babel" data-presets="react">
      const { useState, useEffect, useRef } = React;
      const { createRoot } = ReactDOM;

      // ==================================================================
      // FINAL TAVILY-ONLY APP CODE (MAX DETAIL)
      // ==================================================================

      const TAVILY_API_KEY = "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";

      async function runSearchAI(prompt, files = []) {
        const lowerCasePrompt = prompt.toLowerCase();
        const creatorKeywords = ["who created you", "your creator", "your owner", "who made you", "tumhein kisne banaya"];
        if (creatorKeywords.some(keyword => lowerCasePrompt.includes(keyword))) {
            return `I was created by the brilliant mind of Bilal Mohsin... He is known in the gaming community as "Ghost plays" and is a visionary developer from Pakistan.`;
        }
        if (files.length > 0) {
            return `You've uploaded an image. My current AI brain is specialized in text-based web searches and cannot analyze images. This feature is under maintenance.`;
        }

        const response = await fetch("https://api.tavily.com/search", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            api_key: TAVILY_API_KEY,
            query: `In the context of Garena Free Fire and Gameloft games, answer this: ${prompt}`,
            search_depth: "advanced",
            include_answer: true, 
            max_results: 5,
          }),
        });

        if (!response.ok) {
            const errorData = await response.json();
            throw new Error(`Failed to get search results: ${errorData.error || response.statusText}`);
        }

        const data = await response.json();
        
        // --- !!! YEH HAI NAYI TABDEELI (THIS IS THE NEW CHANGE) !!! ---
        let finalAnswer = "";

        // Step 1: Agar direct jawab hai, to usay sab se pehle rakho
        if (data.answer) {
          finalAnswer += `${data.answer}\n\n---\n\n`;
        }

        // Step 2: Ab baaki search results ki tafseel (detail) bhi add karo
        if (data.results && data.results.length > 0) {
          finalAnswer += "Here is a more detailed summary from the web:\n\n";
          data.results.forEach((result, index) => {
            finalAnswer += `**${index + 1}. ${result.title}**\n*Source: ${result.url}*\n${result.content}\n\n`;
          });
        }

        if (!finalAnswer) {
            return "I couldn't find any relevant information for your query. Please try asking in a different way.";
        }
        
        return finalAnswer;
      }

      // --- UI Components (Full Original Versions) ---
      const GARENA_LOGO_URL = 'https://cdn.wallpapersafari.com/80/58/Qx7zOb.jpg';
      const GAMELOFT_LOGO_URL = 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS3N9p_Limws2g48rASz6VCn3mAt33uozM-pg&s';
      const UserIcon = (props) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" {...props}><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" /></svg>);
      const AiIcon = (props) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" {...props}><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" /><path d="M12 12m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0" fillOpacity="0.5"/><path d="M12 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM6 12c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2zm10 0c0-1.1-.9-2-2-2s-2 .9-2 2 .9 2 2 2 2-.9 2-2z" /></svg>);
      const SendIcon = (props) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" {...props}><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z" /></svg>);
      const PaperclipIcon = (props) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}><path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg>);
      const XCircleIcon = (props) => (<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" {...props}><path fillRule="evenodd" d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zm-1.72 6.97a.75.75 0 10-1.06 1.06L10.94 12l-1.72 1.72a.75.75 0 101.06 1.06L12 13.06l1.72 1.72a.75.75 0 101.06-1.06L13.06 12l1.72-1.72a.75.75 0 10-1.06-1.06L12 10.94l-1.72-1.72z" clipRule="evenodd" /></svg>);
      
      const ChatMessage = ({ message }) => {
        const isUserModel = message.role === 'model';
        return (
          <div className={`flex items-start gap-4 ${isUserModel ? '' : 'justify-end'}`}>
            {isUserModel && (<div className="flex-shrink-0 w-8 h-8 rounded-full bg-amber-500 flex items-center justify-center text-gray-900"><AiIcon className="w-5 h-5" /></div>)}
            <div className={`max-w-xl ${isUserModel ? 'order-2' : 'order-1'}`}>
              <div className={`px-5 py-3 rounded-2xl ${isUserModel ? 'bg-gray-800 text-gray-200 rounded-bl-none' : 'bg-amber-500 text-gray-900 rounded-br-none'}`}>
                {message.files && message.files.length > 0 && ( <div className="mb-2"> <img src={message.files[0].dataUrl} alt={message.files[0].name} className="max-w-xs rounded-lg" /> </div> )}
                <p className="whitespace-pre-wrap text-lg leading-tight tracking-wide break-words">{message.text}</p>
              </div>
            </div>
            {!isUserModel && (<div className="flex-shrink-0 w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-gray-300 order-2"><UserIcon className="w-5 h-5" /></div>)}
          </div>
        );
      };
      
      const ExamplePrompts = ({ onPromptClick, isLoading }) => {
          const prompts = [ "Latest Garena Free Fire tournaments", "فری فائر میں ہیڈ شاٹ کی بہترین سیٹنگز کیا ہیں؟", "Who created you?", "گیم لوفٹ کی کچھ مشہور گیمز کے نام بتائیں" ];
          return ( <div className="flex flex-col items-center justify-center h-full text-gray-300"> <div className="text-center bg-gray-900/30 backdrop-blur-sm p-8 rounded-xl"> <div className="flex justify-center items-center gap-8 mb-6"> <img src={GAMELOFT_LOGO_URL} alt="Gameloft Logo" className="w-24 h-24 rounded-full border-2 border-amber-500 object-cover" /> <img src={GARENA_LOGO_URL} alt="Garena Logo" className="w-24 h-24 rounded-full border-2 border-amber-500 object-cover" /> </div> <h1 className="text-5xl md:text-6xl font-bold text-white tracking-wider">TWO LEGENDS PRO</h1> <p className="text-xl text-gray-400 mt-2">Your AI Assistant</p> </div> <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mt-12 w-full max-w-3xl"> {prompts.map((prompt, index) => (<button key={index} onClick={() => onPromptClick(prompt)} disabled={isLoading} className="p-4 bg-gray-800/80 backdrop-blur-sm border border-gray-700 rounded-lg text-left text-lg hover:bg-gray-700/80 transition-all duration-200 disabled:opacity-50">{prompt}</button>))} </div> </div> );
      };
      
      const ChatInput = ({ onSendMessage, isLoading }) => {
         const [prompt, setPrompt] = useState(''); const [files, setFiles] = useState([]); const fileInputRef = useRef(null); const fileToData = (file) => new Promise((resolve, reject) => { const reader = new FileReader(); reader.readAsDataURL(file); reader.onload = () => resolve({ name: file.name, type: file.type, data: reader.result }); reader.onerror = reject; }); const handleSubmit = async (e) => { e.preventDefault(); if ((prompt.trim() || files.length > 0) && !isLoading) { const uploadedFiles = await Promise.all(files.map(fileToData)); onSendMessage(prompt, uploadedFiles); setPrompt(''); setFiles([]); } }; const handleFileChange = (e) => { if (e.target.files) { setFiles(Array.from(e.target.files)); } }; return ( <div className="bg-gray-900/80 backdrop-blur-sm border-t border-gray-700"> {files.length > 0 && (<div className="p-4 border-b border-gray-700"><div className="relative inline-block"><img src={URL.createObjectURL(files[0])} className="w-24 h-24 object-cover rounded-lg"/><button onClick={() => setFiles([])} className="absolute -top-2 -right-2 bg-gray-800 rounded-full text-white hover:text-red-400"><XCircleIcon className="w-6 h-6"/></button></div></div>)} <form onSubmit={handleSubmit} className="flex items-center gap-3 p-4"> <button type="button" onClick={() => fileInputRef.current?.click()} className="w-12 h-12 flex-shrink-0 text-gray-400 rounded-full flex items-center justify-center hover:bg-gray-700"><PaperclipIcon className="w-6 h-6" /></button> <input type="file" ref={fileInputRef} onChange={handleFileChange} className="hidden" accept="image/*" /> <textarea value={prompt} onChange={(e) => setPrompt(e.target.value)} placeholder="Upload screenshot or ask a question..." rows={1} className="flex-grow bg-gray-700 text-gray-200 placeholder-gray-400 text-lg rounded-full py-3 px-6 resize-none focus:outline-none focus:ring-2 focus:ring-amber-500" disabled={isLoading} /> <button type="submit" disabled={isLoading || (!prompt.trim() && files.length === 0)} className="w-14 h-14 flex-shrink-0 bg-amber-500 text-gray-900 rounded-full flex items-center justify-center transition-colors disabled:bg-gray-600 hover:bg-amber-400"> {isLoading ? (<div className="w-6 h-6 border-2 border-gray-900 border-t-transparent rounded-full animate-spin"></div>) : (<SendIcon className="w-7 h-7" />)} </button> </form> </div> );
      };

      function App() {
        const [messages, setMessages] = useState([]);
        const [isLoading, setIsLoading] = useState(false);
        const chatEndRef = useRef(null);

        useEffect(() => { chatEndRef.current?.scrollIntoView({ behavior: 'smooth' }); }, [messages]);

        const handleSendMessage = async (prompt, files = []) => {
          const userMessage = { role: 'user', text: prompt, files: files };
          setMessages(prev => [...prev, userMessage]);
          setIsLoading(true);
          try {
            const modelText = await runSearchAI(prompt, files);
            setMessages(prev => [...prev, { role: 'model', text: modelText }]);
          } catch (err) {
            setMessages(prev => [...prev, { role: 'model', text: `😥 Error: ${err.message}` }]);
          } finally { setIsLoading(false); }
        };
        
        return (
          <div className="h-screen w-screen bg-gray-900/70 text-white flex flex-col font-teko">
            <header className="flex items-center justify-center gap-4 p-4 bg-gray-900/80 backdrop-blur-sm border-b border-gray-700 shadow-lg">
              <img src={GAMELOFT_LOGO_URL} alt="Gameloft Logo" className="w-10 h-10 rounded-full border-2 border-amber-500 object-cover" />
              <img src={GARENA_LOGO_URL} alt="Garena Logo" className="w-10 h-10 rounded-full border-2 border-amber-500 object-cover" />
              <h1 className="text-4xl font-bold tracking-widest text-amber-400">TWO LEGENDS PRO</h1>
            </header>
            <main className="flex-grow overflow-y-auto p-4 md:p-6">
              <div className="max-w-4xl mx-auto h-full">
                {messages.length === 0 && !isLoading ? ( <ExamplePrompts onPromptClick={handleSendMessage} isLoading={isLoading} /> ) : (
                  <div className="space-y-6">
                    {messages.map((msg, index) => <ChatMessage key={index} message={msg} />)}
                    {isLoading && messages.length > 0 && messages[messages.length-1].role === 'user' && (
                      <div className="flex items-start gap-4">
                        <div className="flex-shrink-0 w-8 h-8 rounded-full bg-amber-500 flex items-center justify-center text-gray-900"><AiIcon className="w-5 h-5" /></div>
                        <div className="max-w-xl"><div className="px-5 py-3 rounded-2xl bg-gray-800 rounded-bl-none flex items-center space-x-2"><span className="w-2 h-2 bg-amber-400 rounded-full animate-pulse"></span><span className="w-2 h-2 bg-amber-400 rounded-full animate-pulse delay-200"></span><span className="w-2 h-2 bg-amber-400 rounded-full animate-pulse delay-400"></span></div></div>
                      </div>
                    )}
                    <div ref={chatEndRef} />
                  </div>
                )}
              </div>
            </main>
            <footer className="w-full max-w-4xl mx-auto">
              <ChatInput onSendMessage={handleSendMessage} isLoading={isLoading} />
            </footer>
          </div>
        );
      }

      const root = createRoot(document.getElementById('root'));
      root.render(<App />);
        <audio 
        ref={audioRef} 
        loop 
        src={musicSrc || ''}
      />
       <input
        type="file"
        ref={musicInputRef}
        onChange={handleMusicUpload}
        accept="audio/*"
        className="hidden"
      />

    </script>
</body>
</html>
